{% extends 'layout.html' %}

{% block title %}Home{% endblock %}

{% block page_content %}
    <style>
        a {
            text-decoration: none !important;
            color: black
        }
    </style>

<div class="container-fluid">
    <div class="d-sm-flex justify-content-between align-items-center mb-4">
        <h3 class="text-dark mb-0">Risposte per {{ current_quiz.title }}</h3>
        <!-- bottone per il dump CSV -->
        <a class="btn btn-primary btn-sm d-none d-sm-inline-block" role="button" href="{{ url_for('main.download', uuid=current_quiz.uuid) }}"><i class="fas fa-download fa-sm text-white-50"></i>&nbsp;Genera report .csv</a>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-12 col-sm-12">
                <ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab" aria-controls="home" aria-selected="true">Per Domanda</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#single" type="button" role="tab" aria-controls="profile" aria-selected="false">Per Compilazione</button>
                    </li>
                </ul>
            </div>
            <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview  -tab">
                    <div class="container">
                    {% for (domanda,tipo) in overview %}
                        <br><br>
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="card shadow lg-12 mb-12">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h3 class="text-primary fw-bold m-0">{{ domanda }}</h3>
                                    </div>
                                    <div class="card-body">
                                        {% if tipo == 1 %}
                                        <table class="table table-striped table-hover table-responsive-lg table-responsive-md table-responsive-sm">
                                            <thead>
                                                <tr>
                                                    <th scope="col text-center align-center">#</th>
                                                    <th scope="col text-center align-center">Risposta</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for risposta_s in overview[(domanda,tipo)] %}
                                                <tr>
                                                    <th scope="row">{{ loop.index }}</th>
                                                    <td>{{ risposta_s }}</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                        {% else %}
                                        <table class="table table-striped table-hover table-responsive-lg table-responsive-md table-responsive-sm">
                                            <thead>
                                                <tr>
                                                    <th scope="col col-md-2">#</th>
                                                    <th scope="col col-md-5">Risposta</th>
                                                    <th scope="col col-md-5">Numero risposte</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for risposta_s in overview[(domanda,tipo)] %}
                                                <tr>
                                                    <th scope="row">{{ loop.index }}</th>
                                                    <td>{{ risposta_s }}</td>
                                                    <td>{{ overview[(domanda,tipo)][risposta_s] }}</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                        <!--<div class="card-body">
                                            <div class="chart-area">
                                                <canvas id="pieChart" style="max-width: 500px;"></canvas>
                                            </div>
                                        </div>-->
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                    <!--<div class="card-body">
                        <div class="chart-area">
                            <canvas data-bss-chart="{&quot;type&quot;:&quot;doughnut&quot;,&quot;data&quot;:{&quot;labels&quot;:[&quot;Direct&quot;,&quot;Social&quot;,&quot;Referral&quot;],&quot;datasets&quot;:[{&quot;label&quot;:&quot;&quot;,&quot;backgroundColor&quot;:[&quot;#4e73df&quot;,&quot;#1cc88a&quot;,&quot;#36b9cc&quot;],&quot;borderColor&quot;:[&quot;#ffffff&quot;,&quot;#ffffff&quot;,&quot;#ffffff&quot;],&quot;data&quot;:[&quot;50&quot;,&quot;30&quot;,&quot;15&quot;]}]},&quot;options&quot;:{&quot;maintainAspectRatio&quot;:false,&quot;legend&quot;:{&quot;display&quot;:false,&quot;labels&quot;:{&quot;fontStyle&quot;:&quot;normal&quot;}},&quot;title&quot;:{&quot;fontStyle&quot;:&quot;normal&quot;}}}">
                            </canvas>
                        </div>
                        <div class="text-center small mt-4"><span class="me-2"><i class="fas fa-circle text-primary"></i>&nbsp;Direct</span><span class="me-2"><i class="fas fa-circle text-success"></i>&nbsp;Social</span><span class="me-2"><i class="fas fa-circle text-info"></i>&nbsp;Refferal</span></div>
                    </div>-->
                </div>
                <div class="tab-pane fade" id="single" role="tabpanel" aria-labelledby="single-tab">
                    <div class="container">
                        {% for i in risposte %}
                        <br><br>
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="card shadow lg-12 mb-12">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h3 class="text-primary fw-bold m-0">Compilazione {{ loop.index }}</h3>
                                    </div>
                                    <div class="card-body">
                                        <table class="table table-striped table-hover table-responsive-lg table-responsive-md table-responsive-sm">
                                            <thead>
                                                <tr>
                                                    <th scope="col text-center align-center">Domanda</th>
                                                    <th scope="col text-center align-center">Risposta</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for j in risposte[i] %}
                                                <tr>
                                                    <th scope="row">{{ j }}</th>
                                                    <td>
                                                        {% if risposte[i][j]|length > 1 %}
                                                        <ul>
                                                            {% for k in risposte[i][j] %}
                                                            <li>{{ k }}</li>
                                                            {% endfor %}
                                                        </ul>
                                                        {% else %}
                                                                {{ risposte[i][j][0] }}
                                                        {% endif %}
                                                    </td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>




</div>
    {% block script_part %}
        <script src="{{ url_for('static', filename='js/chart.min.js') }}"></script>
        <!--<script>
        var ctxP = document.getElementById("pieChart").getContext('2d');
        var myPieChart = new Chart(ctxP, {
          type: 'pie',
          data: {
            labels: ["No", "si", "No, non è multipla", "Si è multipla"],
            datasets: [{
              data: [0, 0, 1, 2],
              backgroundColor: ["#F7464A", "#46BFBD", "#FDB45C", "#949FB1", "#4D5360"],
              hoverBackgroundColor: ["#FF5A5E", "#5AD3D1", "#FFC870", "#A8B3C5", "#616774"]
            }]
          },
          options: {
            responsive: true
          }
        });
        </script>-->
    {% endblock %}
{% endblock %}